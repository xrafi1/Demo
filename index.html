<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Viroo — Video View Platform</title>
  <meta name="description" content="Viroo — lightweight video view platform powered by Google Sheets and GitHub Pages" />
  <style>
    /* Minimal, sexy & responsive UI */
    :root{--bg:#0f1724;--card:#0b1220;--muted:#94a3b8;--accent:linear-gradient(135deg,#ff7a7a,#ffd36b);} 
    *{box-sizing:border-box}
    body{margin:0;font-family:Inter,ui-sans-serif,system-ui,-apple-system,'Segoe UI',Roboto,'Helvetica Neue',Arial;color:#e6eef8;background:linear-gradient(180deg,#071028 0%, #071226 100%);-webkit-font-smoothing:antialiased}
    header{padding:28px 20px;display:flex;align-items:center;justify-content:space-between;gap:12px}
    .brand{display:flex;align-items:center;gap:12px}
    .logo{width:48px;height:48px;border-radius:12px;background:var(--accent);display:flex;align-items:center;justify-content:center;font-weight:700;color:#111}
    h1{font-size:18px;margin:0}
    p.lead{margin:0;color:var(--muted);font-size:13px}
    .controls{display:flex;gap:10px;align-items:center}
    .search{padding:10px 12px;border-radius:12px;border:0;background:#071a2e;color:#bcd3ff;min-width:210px}
    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:18px;padding:20px}
    @media(max-width:1000px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media(max-width:640px){.grid{grid-template-columns:1fr;padding:12px}header{flex-direction:column;align-items:flex-start} .controls{width:100%}}
    .card{background:linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));border-radius:14px;overflow:hidden;box-shadow:0 6px 18px rgba(2,6,23,0.6);transition:transform .22s}
    .card:hover{transform:translateY(-6px)}
    .thumb{position:relative;padding-top:56.25%;background:#020617}
    .thumb img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}
    .play{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);background:rgba(255,255,255,0.12);backdrop-filter:blur(4px);width:56px;height:56px;border-radius:999px;display:flex;align-items:center;justify-content:center}
    .meta{padding:12px}
    .title{font-weight:600;margin:0 0 8px 0;font-size:14px}
    .actions{display:flex;gap:8px;align-items:center}
    .btn{padding:8px 12px;border-radius:10px;border:0;cursor:pointer;font-weight:600}
    .btn.ghost{background:transparent;color:var(--muted)}
    .btn.primary{background:linear-gradient(90deg,#ff7a7a,#ffd36b);color:#081023}
    .small{font-size:13px;color:var(--muted)}
    /* Modal */
    .modal{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:rgba(2,6,23,0.6);z-index:60;padding:20px}
    .modal.open{display:flex}
    .modal-inner{width:100%;max-width:900px;background:#061226;border-radius:14px;overflow:hidden}
    .modal video{width:100%;height:auto;background:#000}
    .modal .modal-body{padding:12px;display:flex;justify-content:space-between;align-items:center}
    footer{padding:18px;color:var(--muted);text-align:center;font-size:13px}
    /* loader */
    .loader{display:inline-block;width:36px;height:36px;border-radius:50%;border:4px solid rgba(255,255,255,0.06);border-top-color:#ffd36b;animation:spin .9s linear infinite}
    @keyframes spin{to{transform:rotate(360deg)}}
  </style>
</head>
<body>
  <header>
    <div class="brand">
      <div class="logo">V</div>
      <div>
        <h1>Viroo</h1>
        <p class="lead">Lightweight video view platform — GitHub Pages + Google Sheets</p>
      </div>
    </div>
    <div class="controls">
      <input id="search" class="search" placeholder="Search videos, titles..." />
      <div id="status" class="small">Loading <span class="loader" style="vertical-align:middle;margin-left:8px"></span></div>
    </div>
  </header>

  <main>
    <div id="grid" class="grid" aria-live="polite"></div>
  </main>

  <div id="modal" class="modal" role="dialog" aria-hidden="true">
    <div class="modal-inner">
      <video id="player" controls playsinline></video>
      <div class="modal-body">
        <div id="modalTitle" style="font-weight:600;color:#e6eef8"></div>
        <div>
          <a id="downloadBtn" class="btn primary" href="#" target="_blank" rel="noopener">Download</a>
          <button id="closeBtn" class="btn ghost">Close</button>
        </div>
      </div>
    </div>
  </div>

  <footer>Built for Viroo • Replace the Google Sheet URL in the script with your own (see instructions)</footer>

  <script>
    // ---------- CONFIG ----------
    // Replace this with your published JSON endpoint (see instructions in the chat)
    const SHEET_JSON_URL = 'REPLACE_WITH_YOUR_SHEET_JSON_ENDPOINT';

    // Expected data format:
    // [{"title":"...","thumb":"https://...","video_url":"https://...","download_url":"https://..."}, ...]

    const grid = document.getElementById('grid');
    const status = document.getElementById('status');
    const search = document.getElementById('search');
    const modal = document.getElementById('modal');
    const player = document.getElementById('player');
    const modalTitle = document.getElementById('modalTitle');
    const downloadBtn = document.getElementById('downloadBtn');
    const closeBtn = document.getElementById('closeBtn');

    let videos = [];

    async function fetchData(){
      try{
        status.innerHTML = 'Loading <span class="loader" style="vertical-align:middle;margin-left:8px"></span>';
        const res = await fetch(SHEET_JSON_URL, {cache: 'no-store'});
        if(!res.ok) throw new Error('Failed to fetch sheet');
        const data = await res.json();
        // If your script wraps results, adapt this line
        videos = Array.isArray(data) ? data : (data.items || data.rows || []);
        renderGrid(videos);
        status.textContent = videos.length + ' videos';
      }catch(err){
        console.error(err);
        status.textContent = 'Error loading data';
        grid.innerHTML = '<div style="grid-column:1/-1;padding:28px;text-align:center;color:#f88">Could not load data — check SHEET_JSON_URL in the script.</div>'
      }
    }

    function renderGrid(list){
      if(!list.length){ grid.innerHTML = '<div style="grid-column:1/-1;padding:28px;text-align:center;color:var(--muted)">No videos found</div>'; return }
      grid.innerHTML = list.map((v, i)=>`
        <article class="card" data-index="${i}" tabindex="0">
          <div class="thumb" role="img" aria-label="${escapeHtml(v.title||'video')}">
            <img src="${escapeHtml(v.thumb||'') || 'data:image/svg+xml;charset=UTF-8,<svg xmlns=\"http://www.w3.org/2000/svg\" width=\"1200\" height=\"675\"></svg>'}" alt="${escapeHtml(v.title||'video')}" loading="lazy" />
            <div class="play">▶</div>
          </div>
          <div class="meta">
            <h3 class="title">${escapeHtml(v.title||'Untitled')}</h3>
            <div class="actions">
              <button class="btn ghost" data-action="play" data-index="${i}">Play</button>
              <a class="btn primary" href="${escapeAttr(v.download_url||v.video_url||'#')}" target="_blank" rel="noopener" download>Download</a>
            </div>
          </div>
        </article>
      `).join('');

      // attach events
      grid.querySelectorAll('[data-action="play"]').forEach(b=>b.addEventListener('click', (e)=>{
        const idx = +e.currentTarget.dataset.index; openModal(idx);
      }));
      grid.querySelectorAll('.card').forEach(card=>{
        card.addEventListener('keydown', (e)=>{ if(e.key === 'Enter') card.querySelector('[data-action="play"]').click(); });
      });
    }

    function openModal(index){
      const v = videos[index];
      if(!v) return;
      player.src = v.video_url || v.download_url || '';
      modalTitle.textContent = v.title || 'Video';
      downloadBtn.href = v.download_url || v.video_url || '#';
      modal.classList.add('open');
      modal.setAttribute('aria-hidden','false');
      player.play().catch(()=>{});
    }

    function closeModal(){
      player.pause(); player.src = ''; modal.classList.remove('open'); modal.setAttribute('aria-hidden','true');
    }

    closeBtn.addEventListener('click', closeModal);
    modal.addEventListener('click', (e)=>{ if(e.target === modal) closeModal(); });

    search.addEventListener('input', ()=>{
      const q = search.value.trim().toLowerCase();
      if(!q) return renderGrid(videos);
      const filtered = videos.filter(v=> (v.title||'').toLowerCase().includes(q));
      renderGrid(filtered);
    });

    function escapeHtml(s){ if(!s) return ''; return s.replace(/[&<>\"']/g, c=>({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c])); }
    function escapeAttr(s){ return escapeHtml(String(s||'')); }

    // initial fetch
    fetchData();

  </script>
</body>
</html>
